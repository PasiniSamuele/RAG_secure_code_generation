schema: '2.0'
stages:
  filter_dataset:
    cmd: python src/filter_dataset.py --data data/FMereani.csv --dest data/filtered.csv
      --params params.yaml
    deps:
    - path: data/FMereani.csv
      hash: md5
      md5: 3f25b32037cab2b97b17e8ad26cf5f5c
      size: 19129116
    - path: src/filter_dataset.py
      hash: md5
      md5: 78a81ea6803e1f0fe79c0a4a9b35d058
      size: 1174
    params:
      params.yaml:
        filter_dataset:
          starting_strs:
          - https://
          - http://
    outs:
    - path: data/filtered.csv
      hash: md5
      md5: 2fc675ff5189b179493acdceeabac0ac
      size: 4228007
  dataset_split:
    cmd: python src/dataset_split.py --data data/filtered.csv --dest_train data/train.csv
      --dest_test data/test.csv --params params.yaml
    deps:
    - path: data/filtered.csv
      hash: md5
      md5: 2fc675ff5189b179493acdceeabac0ac
      size: 4228007
    - path: src/dataset_split.py
      hash: md5
      md5: 7b5377b9be415d41c8580df84eab24ec
      size: 1468
    params:
      params.yaml:
        dataset_split:
          train_size: 0.5
    outs:
    - path: data/test.csv
      hash: md5
      md5: 2729d90175cf8d55989b29f9c79cc65e
      size: 2116897
    - path: data/train.csv
      hash: md5
      md5: ecfaf7d7df5d43f7e2b6612dfc1862a0
      size: 2111125
  dataset_trainval_test_split:
    cmd: python src/dataset_split.py --data data/filtered_oracle.csv --dest_train
      data/trainval.csv --dest_test data/test.csv --split_arguments dataset_trainval_test_split
      --params params.yaml
    deps:
    - path: data/filtered_oracle.csv
      hash: md5
      md5: f246c824a0660b1bfd8b883e33175c3c
      size: 4161460
    - path: src/dataset_split.py
      hash: md5
      md5: c571c3fa613cc9e7fff9d96b40629a6d
      size: 1610
    params:
      params.yaml:
        dataset_trainval_test_split:
          train_size: 0.8
    outs:
    - path: data/test.csv
      hash: md5
      md5: 0445c93403cd252730286e038c4c5168
      size: 836383
    - path: data/trainval.csv
      hash: md5
      md5: 8bc069cf10d032e3116bef35875c67b7
      size: 3325092
  dataset_train_val_split:
    cmd: python src/dataset_split.py --data data/trainval.csv --dest_train data/train.csv
      --dest_test data/val.csv --split_arguments dataset_train_val_split --params
      params.yaml
    deps:
    - path: data/trainval.csv
      hash: md5
      md5: 8bc069cf10d032e3116bef35875c67b7
      size: 3325092
    - path: src/dataset_split.py
      hash: md5
      md5: c571c3fa613cc9e7fff9d96b40629a6d
      size: 1610
    params:
      params.yaml:
        dataset_train_val_split:
          train_size: 0.8
    outs:
    - path: data/train.csv
      hash: md5
      md5: 6f5b7be3ce9a53f3aa1112f83bd59027
      size: 2660843
    - path: data/val.csv
      hash: md5
      md5: 5bbc22c5ce978ef9cc6713b5bb8b5535
      size: 664264
  uniform_dataset:
    cmd: python src/uniform_dataset.py --data data/payload_quoted.csv --dest data/payload_sqli.csv
      --params params.yaml
    deps:
    - path: data/payload_quoted.csv
      hash: md5
      md5: 6686470fd159a686d6fd17d3c08961b0
      size: 764421
    - path: src/uniform_dataset.py
      hash: md5
      md5: 5bb3519f24cce75a2c732426153dda5b
      size: 2546
    params:
      params.yaml:
        uniform_sqli:
          payload_column: payload
          label_column: attack_type
          benign_label: norm
          malicious_label: sqli
          final_benign_label: Benign
          final_malicious_label: Malicious
          final_payload_column: Payloads
          final_label_column: Class
    outs:
    - path: data/payload_sqli.csv
      hash: md5
      md5: 260fffc59aab78edf9a79081b26c5c11
      size: 263623
  sqli_trainval_test_split:
    cmd: python src/dataset_split.py --data data/payload_sqli.csv --dest_train data/trainval_sqli.csv
      --dest_test data/test_sqli.csv --split_arguments dataset_trainval_test_split
      --params params.yaml
    deps:
    - path: data/payload_sqli.csv
      hash: md5
      md5: 260fffc59aab78edf9a79081b26c5c11
      size: 263623
    - path: src/dataset_split.py
      hash: md5
      md5: c571c3fa613cc9e7fff9d96b40629a6d
      size: 1610
    params:
      params.yaml:
        dataset_trainval_test_split:
          train_size: 0.8
    outs:
    - path: data/test_sqli.csv
      hash: md5
      md5: 82ccf8f6269abbd6a1e3329af1e56a6a
      size: 51845
    - path: data/trainval_sqli.csv
      hash: md5
      md5: 239d8f196a6572a66ecabcc51d1d6e1a
      size: 211793
  sqli_train_val_split:
    cmd: python src/dataset_split.py --data data/trainval_sqli.csv --dest_train data/train_sqli.csv
      --dest_test data/val_sqli.csv --split_arguments dataset_train_val_split --params
      params.yaml
    deps:
    - path: data/trainval_sqli.csv
      hash: md5
      md5: 239d8f196a6572a66ecabcc51d1d6e1a
      size: 211793
    - path: src/dataset_split.py
      hash: md5
      md5: c571c3fa613cc9e7fff9d96b40629a6d
      size: 1610
    params:
      params.yaml:
        dataset_train_val_split:
          train_size: 0.8
    outs:
    - path: data/train_sqli.csv
      hash: md5
      md5: 69d43acee87aaf934a08ac2a3845bb83
      size: 169419
    - path: data/val_sqli.csv
      hash: md5
      md5: ba0dfcb8f031f0c32940ebc443b15915
      size: 42389
  fix_dataset_quotes:
    cmd: python src/fix_dataset_quotes.py --data data/payload_mixed.csv --dest data/payload_quoted.csv
    deps:
    - path: data/payload_mixed.csv
      hash: md5
      md5: 38ff928ee312b2b5742f306c5e83c29c
      size: 1996540
    - path: src/fix_dataset_quotes.py
      hash: md5
      md5: 35844637dc4a304cbd2562f7af7d5c4d
      size: 1386
    outs:
    - path: data/payload_quoted.csv
      hash: md5
      md5: 6686470fd159a686d6fd17d3c08961b0
      size: 764421
  filter_dataset_with_oracle:
    cmd: python src/filter_xss_with_oracle.py --data data/filtered.csv --dest data/filtered_oracle.csv
      --endpoint http://127.0.0.1:5555/vuln_backend/1.0/endpoint/
    deps:
    - path: data/filtered.csv
      hash: md5
      md5: 2fc675ff5189b179493acdceeabac0ac
      size: 4228007
    - path: src/filter_xss_with_oracle.py
      hash: md5
      md5: 885b270bc22a115859a5f62999b48a61
      size: 1347
    outs:
    - path: data/filtered_oracle.csv
      hash: md5
      md5: f246c824a0660b1bfd8b883e33175c3c
      size: 4161460
